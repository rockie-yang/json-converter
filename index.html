<html>

<head>
  <!-- to avoid Uncaught SyntaxError: Unexpected token ILLEGAL: -->
  <meta http-equiv="content-type" content="text/html; charset=UTF8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.6/angular.min.js"></script>
  <style type="text/css">
    html, body {
      margin: 0px;
      padding: 0px;
    }

    .navbar {
      margin-top: 0;
    }

    .editor {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      height: 700px;
    }
  </style>
</head>

<body ng-app>
<div class="navbar navbar-inverse navbar-static-top">
  <div class="container">
    <a href="#" class="navbar-brand">Converter, Convert JSON from left to right</a>
  </div>
</div>
<div class="container">
  <div class="row">
    <div class="col-sm-6">
      <form>
        <div class="row">
          <div class="col-sm-2">
            <!--A dropdown button to choose which theme to use for the left editor-->
            <button class="btn btn-default dropdown-toggle" type="button"
                    id="dropdown-left-theme" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              theme
              <span class="caret"></span>
              <span class="glyphicon glyphicon-exclamation-sign" id="convertStatus" style="color:red;display:none"></span>
            </button>
            <ul class="dropdown-menu" id="left-themes" aria-labelledby="dropdown-left-theme">
              <!--<li><a href="#" class="left-theme">github</a></li>-->
              <!--<li><a href="#" class="left-theme">chaos</a></li>-->
              <!--<li><a href="#" class="left-theme">chrome</a></li>-->
            </ul>

          </div>
          <div class="col-sm-9">
            <input id="urlLeft" type="text" class="form-control" placeholder="url which has json content">
          </div>


        </div>

      </form>
      <div id="editorLeft" class="editor">{a:1}</div>

    </div>
    <div class="col-sm-6">
<form>
      <div class="row">
        <div class="col-sm-10">
          <div class="btn-group">
            <button type="button" data-spaces="" class="btn btn-default btn-set-space">No Space</button>
            <button type="button" data-spaces="  " class="btn btn-default active btn-set-space">2 Space</button>
            <button type="button" data-spaces="   " class="btn btn-default btn-set-space">3 Space</button>
            <button type="button" data-spaces="    " class="btn btn-default btn-set-space">4 Space</button>
            <button type="button" data-spaces="tab" class="btn btn-default btn-set-space">Tab</button>
          </div>
          </div>
        <div class="col-sm-2">
      <!--A dropdown button to choose which theme to use for the left editor-->
      <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button"
                id="dropdown-right-theme" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
          theme
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" id="right-themes" aria-labelledby="dropdown-right-theme">
          <!--<li><a href="#" class="right-theme">github</a></li>-->
          <!--<li><a href="#" class="right-theme">chaos</a></li>-->
          <!--<li><a href="#" class="right-theme">chrome</a></li>-->
        </ul>
      </div>
        </div>
      </div>
</form>
      <div id="editorRight" class="editor">{"a":1}</div>
    </div>
  </div>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ace.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.10/clipboard.min.js"></script>
<script type="text/javascript">
  (function () {
    var editorLeft = ace.edit("editorLeft");
    editorLeft.setTheme("ace/theme/github");
    editorLeft.getSession().setMode("ace/mode/json");
    editorLeft.$blockScrolling = Infinity;

    var editorRight = ace.edit("editorRight");
    editorRight.setTheme("ace/theme/github");
    editorRight.getSession().setMode("ace/mode/json");


    var spaces = '  ';

////    editorRight.setOptions({
////      readOnly: true,
////      highlightActiveLine: false,
////      highlightGutterLine: false
////    })
////    editorRight.renderer.$cursorLayer.element.style.opacity = 0

    function convert() {
      try {
        eval("var jsonObjectInMem=" + editorLeft.getValue());
        editorRight.setValue(JSON.stringify(jsonObjectInMem, null, spaces));
        $('#convertStatus').hide();
      }
      catch (err) {
        $('#convertStatus').show();
      }
    }
    editorLeft.getSession().on('change', function (e) {
      convert();

    });

    $(".btn-set-space").on('click', function(e){
      $(".btn-set-space").removeClass("active");

      spaces = $(this).data('spaces');
      if (spaces == 'tab') {
        spaces = '\t';
      }

      $(this).addClass("active");

      convert();

    });


    $("#urlLeft").bind("paste", function(e){
      // access the clipboard using the api
      var url = e.originalEvent.clipboardData.getData('text');

      $.getJSON(url, function(data) {
        console.log(data.result);
        editorLeft.setValue(JSON.stringify(data, null, 2));
        convert();
      })

    } );

    function appendThemes() {
      var themes = ['ambiance', 'dawn', 'kr_theme', 'solarized_dark', 'omorrow_night_blue',
      'chaos', 'dreamweaver', 'kuroir', 'solarized_light.css		tomorrow_night_bright',
      'chrome', 'eclipse', 'merbivore', 'sqlserver', 'tomorrow_night_eighties',
      'clouds', 'github', 'merbivore_soft',	'terminal', 'twilight',
      'clouds_midnight', 'idle_fingers','mono_industrial','textmate', 'vibrant_ink',
      'cobalt', /*'iplastic', 'monokai', 'tomorrow', 'xcode',
      'crimson_editor', 'katzenmilch', 'pastel_on_dark', 'tomorrow_night'*/].sort();

      for (var i in themes) {
        var theme = themes[i];

        var liLeft = '<li><a href="#" class="left-theme">' + theme + '</a></li>';
        var liRight = '<li><a href="#" class="right-theme">' + theme + '</a></li>';
        $("#left-themes").append(liLeft);
        $("#right-themes").append(liRight);
      }
    }

    appendThemes();
    $(".right-theme").on('click', function () {
      console.log($(this).text());
      editorRight.setTheme("ace/theme/" + $(this).text());
    })
    $(".left-theme").on('click', function () {
      console.log($(this).text());
      editorLeft.setTheme("ace/theme/" + $(this).text());
    })

  }());
</script>
</body>

</html>
